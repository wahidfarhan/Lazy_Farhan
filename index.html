<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Farhans Code - Practice & Run</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/theme/dracula.min.css" />
  <style>
    body {
      margin: 0;
      display: flex;
      flex-direction: column;
      height: 100vh;
      font-family: 'Segoe UI', Tahoma, sans-serif;
      background: #0d1117;
      color: #c9d1d9;
      overflow: hidden;
    }
    #container {
      flex: 1;
      display: flex;
      overflow: hidden;
    }
    #sidebar {
      width: 280px;
      background: #161b22;
      border-right: 3px solid #30363d;
      padding: 15px;
      overflow-y: auto;
    }
    #sidebar h2 {
      margin: 0 0 15px;
      border-bottom: 2px solid #238636;
      color: #238636;
    }
    #fileList {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    #fileList li {
      background: #21262d;
      padding: 8px;
      margin-bottom: 6px;
      border-radius: 5px;
      cursor: pointer;
      user-select: none;
      transition: background-color 0.3s ease;
    }
    #fileList li.active {
      background: #238636;
      color: white;
    }
    #fileList li:hover:not(.active) {
      background: #2ea043;
      color: white;
    }
    #main {
      flex: 1;
      display: flex;
      flex-direction: column;
      padding: 15px;
      overflow: hidden;
      position: relative;
    }
    #codeSection {
      display: flex;
      gap: 20px;
      flex: 1;
      overflow: hidden;
    }
    #codeContainer {
      flex: 2;
      background: #0d1117;
      border: 3px solid #238636;
      border-radius: 6px;
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }
    .CodeMirror {
      height: 100%;
      font-size: 14px;
      background-color: #0d1117;
      color: #c9d1d9;
    }
    #ioSide {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 12px;
      overflow: hidden;
    }
    .io-box label {
      font-weight: bold;
      color: #238636;
      margin-bottom: 5px;
    }
    textarea {
      width: 100%;
      background-color: #21262d;
      color: #c9d1d9;
      border: 2px solid #238636;
      border-radius: 5px;
      padding: 10px;
      resize: vertical;
      min-height: 80px;
      font-family: monospace;
      font-size: 14px;
    }
    #runBtn {
      margin-top: 10px;
      background: #238636;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      color: white;
      font-weight: bold;
      font-size: 16px;
      cursor: pointer;
      align-self: flex-start;
    }
    #runBtn:hover {
      background: #2ea043;
    }
    #statusMsg {
      margin-top: 8px;
      color: #999;
      min-height: 20px;
      font-style: italic;
    }
    .readonly-box {
      background-color: #1e1e1e;
      border: 2px solid #444;
      border-radius: 5px;
      padding: 10px;
      white-space: pre-wrap;
      font-size: 14px;
      min-height: 80px;
      overflow-y: auto;
    }

    /* Responsive for Mobile */
    @media (max-width: 768px) {
      #codeSection {
        flex-direction: column;
      }
      #sidebar {
        width: 100%;
        border-right: none;
        border-bottom: 3px solid #30363d;
        height: 200px;
      }
      #main {
        padding: 10px;
      }
      #codeContainer {
        height: 300px;
      }
      textarea {
        min-height: 60px;
        font-size: 13px;
      }
      #runBtn {
        width: 100%;
        font-size: 18px;
      }
    }
  </style>
</head>
<body>
<div id="container">
  <div id="sidebar">
    <h2>Farhans Code</h2>
    <ul id="fileList"><li>Loading...</li></ul>
  </div>
  <div id="main">
    <div id="codeSection">
      <div id="codeContainer">
        <textarea id="codeEditor">// Select a C file to load code</textarea>
      </div>
      <div id="ioSide">
        <div class="io-box">
          <label for="input">üì• Input</label>
          <textarea id="input"></textarea>
        </div>
        <div class="io-box">
          <label for="output">üì§ Output</label>
          <textarea id="output" readonly></textarea>
        </div>
        <div class="io-box">
          <label>‚úÖ Expected Output</label>
          <div id="expectedOutput" class="readonly-box">Not loaded</div>
        </div>
        <div class="io-box">
          <label>üìù Description</label>
          <div id="descriptionBox" class="readonly-box">No description available.</div>
        </div>
      </div>
    </div>
    <button id="runBtn">Run Code</button>
    <div id="statusMsg"></div>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/clike/clike.min.js"></script>

<script>
  const repoOwner = "wahidfarhan";
  const repoName = "Lazy_Farhan";
  const rootPath = "codes";

  const fileListEl = document.getElementById("fileList");
  const inputEl = document.getElementById("input");
  const outputEl = document.getElementById("output");
  const descriptionEl = document.getElementById("descriptionBox");
  const expectedOutputEl = document.getElementById("expectedOutput");
  const statusMsg = document.getElementById("statusMsg");

  let editor = CodeMirror.fromTextArea(document.getElementById("codeEditor"), {
    mode: "text/x-csrc",
    theme: "dracula",
    lineNumbers: true,
    indentUnit: 4,
    tabSize: 4,
    autofocus: true
  });

  async function fetchFolderContent(path) {
    const url = `https://api.github.com/repos/${repoOwner}/${repoName}/contents/${path}`;
    const res = await fetch(url);
    if (!res.ok) throw new Error("Failed to fetch folder contents");
    return await res.json();
  }

  async function loadFile(file) {
    const res = await fetch(file.download_url);
    const codeText = await res.text();
    editor.setValue(codeText);

    const inputUrl = file.download_url.replace(/\\/[^/]+$/, `/${file.name.replace(/\\.c$/, '.in')}`);
    try {
      const inputRes = await fetch(inputUrl);
      const inputText = await inputRes.text();
      const sections = inputText.split(/\\r?\\n/);
      let section = \"input\", input = [], output = [], desc = [];
      for (let line of sections) {
        const low = line.trim().toLowerCase();
        if (low === \"description\") section = \"description\";
        else if (low === \"output\") section = \"output\";
        else if (section === \"input\") input.push(line);
        else if (section === \"description\") desc.push(line);
        else if (section === \"output\") output.push(line);
      }
      inputEl.value = input.join(\"\\n\");
      expectedOutputEl.textContent = output.join(\"\\n\") || \"Not available.\";
      descriptionEl.textContent = desc.join(\"\\n\") || \"No description.\";
    } catch {
      inputEl.value = \"\";
      expectedOutputEl.textContent = \"Not available.\";
      descriptionEl.textContent = \"No input or description.\";
    }
  }

  async function showFolder(path) {
    fileListEl.innerHTML = \"<li>Loading...</li>\";
    try {
      const data = await fetchFolderContent(path);
      fileListEl.innerHTML = \"\";
      data.forEach(file => {
        const li = document.createElement(\"li\");
        li.textContent = file.name;
        if (file.type === \"dir\") {
          li.addEventListener(\"click\", () => showFolder(`${path}/${file.name}`));
        } else if (file.name.endsWith(\".c\")) {
          li.addEventListener(\"click\", () => loadFile(file));
        } else {
          return;
        }
        fileListEl.appendChild(li);
      });
    } catch {
      fileListEl.innerHTML = \"<li style='color:red;'>Error loading content</li>\";
    }
  }

  async function runCode() {
    const code = editor.getValue();
    const input = inputEl.value;
    statusMsg.textContent = \"Running...\";
    outputEl.value = \"\";

    try {
      const res = await fetch(\"https://judge0-ce.p.rapidapi.com/submissions?base64_encoded=false&wait=true\", {
        method: \"POST\",
        headers: {
          \"content-type\": \"application/json\",
          \"X-RapidAPI-Host\": \"judge0-ce.p.rapidapi.com\",
          \"X-RapidAPI-Key\": \"2ffb7c9968msh2aaee0147c376edp10350djsne858c3d03a02\" // replace if needed
        },
        body: JSON.stringify({
          source_code: code,
          language_id: 50,
          stdin: input
        })
      });

      const result = await res.json();
      outputEl.value = result.stdout || result.stderr || \"No output.\";
      statusMsg.textContent = \"Finished.\";
    } catch (err) {
      outputEl.value = \"Error running code.\";
      console.error(err);
    }
  }

  document.getElementById(\"runBtn\").addEventListener(\"click\", runCode);

  // Start with root
  showFolder(rootPath);
</script>
</body>
</html>
