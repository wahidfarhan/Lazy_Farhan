<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>Farhans Practice Problems</title>

  <!-- Highlight.js atom-one-dark theme -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/atom-one-dark-reasonable.min.css" />
  <!-- Highlight.js line numbers -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/wcoder/highlightjs-line-numbers.js@2.8.0/dist/highlightjs-line-numbers.min.css" />

  <style>
    :root {
      --green: #238636;
      --green-light: #2ea043;
      --bg: #0d1117;
      --bg-alt: #161b22;
      --border: #30363d;
      --text: #c9d1d9;
      --sidebar-width: 280px;
      --transition-speed: 0.3s;
      --scrollbar-bg: #1e1e1e;
      --scrollbar-thumb: #02ff00;
      --scrollbar-thumb-hover: #333;
    }
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, sans-serif;
      background: var(--bg);
      color: var(--text);
      overflow-x: hidden;
      height: 100vh;
      display: flex;
      flex-direction: column;
    }
    #container {
      display: flex;
      flex: 1 1 auto;
      height: 100%;
      overflow: hidden;
      background: var(--bg);
    }
    /* Sidebar */
    #sidebar {
      width: var(--sidebar-width);
      background: var(--bg-alt);
      border-right: 3px solid var(--border);
      padding: 15px 10px 15px 15px;
      scrollbar-width: thin;
      scrollbar-color: var(--scrollbar-thumb) var(--scrollbar-bg);
      transition: width var(--transition-speed);
      flex-shrink: 0;
      display: flex;
      flex-direction: column;
    }
    #sidebar::-webkit-scrollbar {
      width: 12px;
      background-color: var(--scrollbar-bg);
    }
    #sidebar::-webkit-scrollbar-thumb {
      background-color: var(--scrollbar-thumb);
      border-radius: 6px;
      border: 3px solid var(--scrollbar-bg);
    }
    #sidebar::-webkit-scrollbar-thumb:hover {
      background-color: var(--scrollbar-thumb-hover);
    }
    #sidebar h2 {
      color: var(--green);
      border-bottom: 2px solid var(--green);
      margin-bottom: 15px;
      font-size: 1.25rem;
      user-select: none;
    }
    #fileList {
      list-style: none;
      padding: 0;
      margin: 0;
      flex-grow: 1;
      overflow-y: scroll;
      scrollbar-width: thin;
      scrollbar-color: var(--scrollbar-thumb) #161b22;
    }
    #fileList::-webkit-scrollbar {
      width: 12px;
      background-color: var(--scrollbar-bg);
    }
    #fileList::-webkit-scrollbar-thumb {
      background-color: var(--scrollbar-thumb);
      border-radius: 6px;
      border: 3px solid var(--scrollbar-bg);
    }
    #fileList::-webkit-scrollbar-thumb:hover {
      background-color: var(--scrollbar-thumb-hover);
    }
    #fileList li {
      background: #21262d;
      padding: 8px 12px;
      margin-bottom: 6px;
      border-radius: 5px;
      cursor: pointer;
      transition: background var(--transition-speed), color var(--transition-speed);
      font-size: 0.9rem;
      user-select: none;
      overflow: hidden;
    }
    #fileList li.active {
      background: var(--green);
      color: white;
      font-weight: 600;
    }
    #fileList li:hover:not(.active) {
      background: var(--green-light);
      color: white;
    }
    /* Back button styling */
    #fileList li.back-button {
      font-weight: 700;
      background-color: #0a4d1b;
      color: #b2f2bb;
      margin-bottom: 12px;
      border-radius: 8px;
      text-align: center;
      box-shadow: 0 0 6px 1px #238636aa;
      user-select: none;
      transition: background-color 0.3s ease;
    }
    #fileList li.back-button:hover {
      background-color: #169a2c;
      color: white;
      box-shadow: 0 0 12px 2px #2ea043cc;
    }
    /* Main content */
    #main {
      flex: 1 1 auto;
      display: flex;
      flex-direction: column;
      padding: 15px 20px;
      overflow: hidden;
      min-width: 0;
    }
    #codeSection {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      flex: 1 1 auto;
      min-height: 600px;
      overflow: hidden;
    }
    #codeContainer {
      flex: 2 1 60%;
      min-width: 300px;
      border: 3px solid var(--green);
      border-radius: 6px;
      overflow: auto;
      max-height: 600px;
      background: #282c34;
      scrollbar-width: thin;
      scrollbar-color: var(--scrollbar-thumb) var(--scrollbar-bg);
    }
    #codeContainer::-webkit-scrollbar {
      width: 12px;
      background-color: var(--scrollbar-bg);
    }
    #codeContainer::-webkit-scrollbar-thumb {
      background-color: var(--scrollbar-thumb);
      border-radius: 6px;
      border: 3px solid var(--scrollbar-bg);
    }
    #codeContainer::-webkit-scrollbar-thumb:hover {
      background-color: var(--scrollbar-thumb-hover);
    }
    pre {
      margin: 0;
      padding: 15px;
      font-size: 14px;
      white-space: pre-wrap;
      word-break: break-word;
      min-height: 400px;
      font-family: monospace;
    }
    #ioSide {
      flex: 1 1 35%;
      display: flex;
      flex-direction: column;
      gap: 12px;
      min-width: 250px;
      max-height: 600px;
      overflow: hidden;
    }
    .io-box {
      display: flex;
      flex-direction: column;
      max-height: 33vh;
      scrollbar-width: thin;
      scrollbar-color: var(--scrollbar-thumb) var(--scrollbar-bg);
    }
    .io-box::-webkit-scrollbar {
      width: 12px;
      background-color: var(--scrollbar-bg);
    }
    .io-box::-webkit-scrollbar-thumb {
      background-color: var(--scrollbar-thumb);
      border-radius: 6px;
      border: 3px solid var(--scrollbar-bg);
    }
    .io-box::-webkit-scrollbar-thumb:hover {
      background-color: var(--scrollbar-thumb-hover);
    }
    .io-box label {
      font-weight: bold;
      color: var(--green);
      margin-bottom: 5px;
      font-size: 0.95rem;
      user-select: none;
      flex-shrink: 0;
    }
    textarea, .readonly-box {
      width: 100%;
      background-color: #21262d;
      color: var(--text);
      border: 2px solid var(--green);
      border-radius: 5px;
      padding: 10px;
      resize: vertical;
      font-family: monospace;
      font-size: 14px;
      min-height: 80px;
      max-height: 150px;
      overflow-y: scroll;
      transition: border-color var(--transition-speed);
      flex-grow: 1;
      scrollbar-width: thin;
      scrollbar-color: var(--scrollbar-thumb) var(--scrollbar-bg);
    }
    textarea::-webkit-scrollbar, .readonly-box::-webkit-scrollbar {
      width: 12px;
      background-color: var(--scrollbar-bg);
    }
    textarea::-webkit-scrollbar-thumb, .readonly-box::-webkit-scrollbar-thumb {
      background-color: var(--scrollbar-thumb);
      border-radius: 6px;
      border: 3px solid var(--scrollbar-bg);
    }
    textarea::-webkit-scrollbar-thumb:hover, .readonly-box::-webkit-scrollbar-thumb:hover {
      background-color: var(--scrollbar-thumb-hover);
    }
    textarea:focus {
      outline: none;
      border-color: var(--green-light);
      background-color: #1c252b;
    }
    .readonly-box {
      background-color: #1e1e1e;
      white-space: pre-wrap;
    }
    #descriptionBox {
      min-height: 190px;
      max-height: 250px;
      overflow-y: scroll;
      flex-grow: 1;
      scrollbar-width: thin;
      scrollbar-color: var(--scrollbar-thumb) var(--scrollbar-bg);
    }
    #descriptionBox::-webkit-scrollbar {
      width: 12px;
      background-color: var(--scrollbar-bg);
    }
    #descriptionBox::-webkit-scrollbar-thumb {
      background-color: var(--scrollbar-thumb);
      border-radius: 6px;
      border: 3px solid var(--scrollbar-bg);
    }
    #descriptionBox::-webkit-scrollbar-thumb:hover {
      background-color: var(--scrollbar-thumb-hover);
    }
    #runBtn {
      margin-top: 15px;
      background: var(--green);
      border: none;
      padding: 14px 24px;
      border-radius: 5px;
      color: white;
      font-weight: bold;
      font-size: 17px;
      cursor: pointer;
      align-self: flex-start;
      transition: background var(--transition-speed);
      user-select: none;
      min-width: 120px;
    }
    #runBtn:hover, #runBtn:focus {
      background: var(--green-light);
      outline: none;
    }
    #statusMsg {
      margin-top: 10px;
      font-style: italic;
      color: #999;
      min-height: 22px;
      user-select: none;
    }
    #expectedOutput {
      font-size: 14px;
      line-height: 1.5;
      white-space: pre-wrap;
      max-height: 140px;
      overflow-y: scroll;
      flex-grow: 1;
      scrollbar-width: thin;
      scrollbar-color: var(--scrollbar-thumb) #1e1e1e;
    }
    #expectedOutput::-webkit-scrollbar {
      width: 12px;
      background-color: var(--scrollbar-bg);
    }
    #expectedOutput::-webkit-scrollbar-thumb {
      background-color: var(--scrollbar-thumb);
      border-radius: 6px;
      border: 3px solid var(--scrollbar-bg);
    }
    #expectedOutput::-webkit-scrollbar-thumb:hover {
      background-color: var(--scrollbar-thumb-hover);
    }
    #uploadedDate {
      margin-top: 10px;
      font-size: 0.9em;
      color: #56d364;
      text-align: right;
      user-select: none;
      flex-shrink: 0;
    }
    #fileNameLabel {
      color: #56d364;
      font-weight: normal;
      font-size: 0.9em;
      margin-left: 8px;
      user-select: none;
    }
    #typingContainer {
      height: 40px;
      background: var(--bg-alt);
      border-top: 3px solid var(--green);
      color: var(--green);
      font-family: 'Courier New', Courier, monospace;
      font-weight: bold;
      font-size: 18px;
      padding-left: 15px;
      display: flex;
      align-items: center;
      overflow: hidden;
      user-select: none;
      flex-shrink: 0;
    }
    #typingText {
      border-right: 2px solid var(--green);
      white-space: nowrap;
      overflow: hidden;
    }
    /* Responsive */
    @media (max-width: 1024px) {
      #codeContainer { max-height: 400px; }
      #ioSide { max-height: 400px; }
    }
    @media (max-width: 768px) {
      body { height: auto; }
      #container { flex-direction: column; height: auto; }
      #sidebar {
        width: 100%;
        height: auto;
        border-right: none;
        border-bottom: 3px solid var(--border);
        padding: 10px;
        max-height: 240px;
        overflow-y: scroll;
      }
      #sidebar h2 { font-size: 1.1rem; }
      #fileList li { font-size: 0.85rem; padding: 8px 10px; }
      #main { padding: 15px 10px 10px 10px; }
      #codeSection { flex-direction: column; gap: 15px; }
      #codeContainer {
        flex: none;
        min-width: 100%;
        max-height: 350px;
        min-height: 300px;
        border-radius: 5px;
      }
      #ioSide { flex: none; min-width: 100%; max-height: none; }
      #runBtn { width: 100%; font-size: 16px; padding: 14px 0; min-width: unset; }
      #typingContainer { font-size: 16px; height: 35px; padding-left: 10px; }
      #uploadedDate { text-align: center; }
      #descriptionBox { max-height: 300px; min-height: 150px; }
    }
    @media (max-width: 480px) {
      #sidebar { max-height: 200px; padding: 8px; }
      #sidebar h2 { font-size: 1rem; }
      #fileList li { font-size: 0.8rem; padding: 6px 8px; }
      #codeContainer pre { font-size: 13px; padding: 12px; min-height: 250px; }
      textarea, .readonly-box { font-size: 13px; min-height: 70px; max-height: 120px; }
      #runBtn { font-size: 15px; padding: 12px 0; }
      #typingContainer { font-size: 14px; height: 30px; padding-left: 8px; }
    }

    /* Code line numbers and indent guide styling */
    .hljs-ln td.hljs-ln-code {
      position: relative;
      padding-left: 1.5em !important; /* leave space for indent guides */
    }
    .hljs-ln td.hljs-ln-code::before {
      content: "";
      position: absolute;
      left: 0.75em;
      top: 0;
      bottom: 0;
      width: 1px;
      background: rgba(255, 255, 255, 0.15);
      pointer-events: none;
    }
  </style>
</head>
<body>
  <div id="container">
    <div id="sidebar" role="navigation" aria-label="File list">
      <h2>Farhans Practice Problems</h2>
      <ul id="fileList" tabindex="0"><li>Loading folders...</li></ul>
    </div>
    <div id="main">
      <div id="codeSection">
        <div id="codeContainer" aria-label="Code display area">
          <pre><code id="codeBlock" class="c hljs" tabindex="0"></code></pre>
        </div>
        <div id="ioSide">
          <div class="io-box">
            <label for="input">📥 Input</label>
            <textarea id="input" placeholder="Input will be loaded here or you can type" spellcheck="false" autocomplete="off"></textarea>
          </div>
          <div class="io-box">
            <label for="output">📤 Output</label>
            <textarea id="output" readonly placeholder="Program output will appear here" spellcheck="false" autocomplete="off"></textarea>
          </div>
          <div class="io-box">
            <label>✅ Expected Output</label>
            <div id="expectedOutput" class="readonly-box" tabindex="0" aria-live="polite">Not loaded</div>
          </div>
          <div class="io-box" style="flex-grow:1; display:flex; flex-direction:column;">
            <label>📝 Description <span id="fileNameLabel"></span></label>
            <div id="descriptionBox" class="readonly-box" tabindex="0" aria-live="polite">Loading description...</div>
          </div>
          <button id="runBtn" aria-label="Run code">Run Code ▶️</button>
          <div id="statusMsg" aria-live="polite"></div>
          <div id="uploadedDate" aria-label="Upload date"></div>
        </div>
      </div>
      <div id="typingContainer" aria-live="polite" aria-atomic="true"><span id="typingText"></span></div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/c.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/wcoder/highlightjs-line-numbers.js@2.8.0/dist/highlightjs-line-numbers.min.js"></script>

  <script>
    const repoOwner = "FarhanWahid13";
    const repoName = "Lazy_Farhan";
    const folderPath = "codes";

    const fileListEl = document.getElementById("fileList");
    const codeBlockEl = document.getElementById("codeBlock");
    const inputEl = document.getElementById("input");
    const outputEl = document.getElementById("output");
    const expectedOutputEl = document.getElementById("expectedOutput");
    const descriptionBoxEl = document.getElementById("descriptionBox");
    const runBtn = document.getElementById("runBtn");
    const statusMsg = document.getElementById("statusMsg");
    const uploadedDateEl = document.getElementById("uploadedDate");
    const fileNameLabel = document.getElementById("fileNameLabel");

    let currentFolder = folderPath;
    let fileTreeStack = [];
    let currentFileName = "";

    // Fetch and display files/folders in given path
    async function showFolder(path) {
      fileListEl.innerHTML = "<li>Loading...</li>";
      try {
        let apiUrl = `https://api.github.com/repos/${repoOwner}/${repoName}/contents/${path}`;
        const response = await fetch(apiUrl);
        if (!response.ok) throw new Error("Failed to load folder");
        const items = await response.json();

        // Filter .c files and folders
        const filtered = items.filter(i => i.type === "file" && i.name.endsWith(".c") || i.type === "dir")
                              .sort((a,b) => (a.type === "dir" && b.type === "file") ? -1 : 1);

        fileListEl.innerHTML = "";
        if (fileTreeStack.length > 0) {
          // Add back button
          const backLi = document.createElement("li");
          backLi.textContent = "⬅ Back";
          backLi.classList.add("back-button");
          backLi.tabIndex = 0;
          backLi.setAttribute("role", "button");
          backLi.onclick = () => {
            const prev = fileTreeStack.pop();
            currentFolder = prev || folderPath;
            showFolder(currentFolder);
          };
          backLi.onkeypress = e => { if (e.key === "Enter" || e.key === " ") backLi.onclick(); };
          fileListEl.appendChild(backLi);
        }

        filtered.forEach(item => {
          const li = document.createElement("li");
          li.textContent = item.name;
          li.tabIndex = 0;
          li.setAttribute("role", "button");
          li.classList.add(item.type === "dir" ? "folder" : "file");
          li.onclick = () => {
            if (item.type === "dir") {
              fileTreeStack.push(currentFolder);
              currentFolder = item.path;
              showFolder(item.path);
            } else {
              loadCodeFile(item.path);
            }
          };
          li.onkeypress = e => { if (e.key === "Enter" || e.key === " ") li.onclick(); };
          fileListEl.appendChild(li);
        });
      } catch (error) {
        fileListEl.innerHTML = `<li style="color:#f33;">Error loading files</li>`;
        console.error(error);
      }
    }

    // Load code file and related info
    async function loadCodeFile(filePath) {
      try {
        statusMsg.textContent = "Loading code...";
        fileNameLabel.textContent = filePath.split('/').pop();
        currentFileName = filePath;
        uploadedDateEl.textContent = "";
        expectedOutputEl.textContent = "Loading expected output...";
        descriptionBoxEl.textContent = "Loading description...";
        outputEl.value = "";
        inputEl.value = "";

        // Fetch code content
        const codeResp = await fetch(`https://raw.githubusercontent.com/${repoOwner}/${repoName}/main/${filePath}`);
        if (!codeResp.ok) throw new Error("Failed to load code file");
        const codeText = await codeResp.text();
        codeBlockEl.textContent = codeText;

        // Highlight and line numbers
        hljs.highlightElement(codeBlockEl);
        hljs.lineNumbersBlock(codeBlockEl);

        // Add indentation guides
        addIndentGuides();

        // Fetch expected output and description JSON
        // Expected output file name: same name + ".output.txt"
        const expectedOutputPath = filePath.replace(/\.c$/, ".output.txt");
        const expectedOutputResp = await fetch(`https://raw.githubusercontent.com/${repoOwner}/${repoName}/main/${expectedOutputPath}`);
        if (expectedOutputResp.ok) {
          expectedOutputEl.textContent = await expectedOutputResp.text();
        } else {
          expectedOutputEl.textContent = "No expected output found.";
        }

        // Fetch description file name: same name + ".desc.txt"
        const descriptionPath = filePath.replace(/\.c$/, ".desc.txt");
        const descriptionResp = await fetch(`https://raw.githubusercontent.com/${repoOwner}/${repoName}/main/${descriptionPath}`);
        if (descriptionResp.ok) {
          descriptionBoxEl.textContent = await descriptionResp.text();
        } else {
          descriptionBoxEl.textContent = "No description available.";
        }

        // Fetch commit history for upload date
        const commitsUrl = `https://api.github.com/repos/${repoOwner}/${repoName}/commits?path=${filePath}&per_page=1`;
        const commitsResp = await fetch(commitsUrl);
        if (commitsResp.ok) {
          const commits = await commitsResp.json();
          if (commits.length > 0) {
            const date = new Date(commits[0].commit.committer.date);
            uploadedDateEl.textContent = "Last updated: " + date.toLocaleString();
          }
        }

        statusMsg.textContent = "";
      } catch (error) {
        statusMsg.textContent = "Error loading file.";
        console.error(error);
      }
    }

    // Add vertical indent guides (vertical faint line for indents)
    function addIndentGuides() {
      document.querySelectorAll('.hljs-ln td.hljs-ln-code').forEach(td => {
        const text = td.innerText || "";
        const indentMatch = text.match(/^(\s+)/);
        const indentLength = indentMatch ? indentMatch[1].length : 0;
        td.style.paddingLeft = (1.5 + indentLength * 0.6) + "em";
      });
    }

    // Zoom support Ctrl + mousewheel on code block container
    const codeContainer = document.getElementById("codeContainer");
    let zoomLevel = 1;
    const baseFontSize = 14;
    codeContainer.style.fontSize = baseFontSize + "px";

    codeContainer.addEventListener("wheel", e => {
      if (e.ctrlKey) {
        e.preventDefault();
        zoomLevel += e.deltaY < 0 ? 0.1 : -0.1;
        zoomLevel = Math.min(Math.max(zoomLevel, 0.5), 3);
        codeContainer.style.fontSize = (baseFontSize * zoomLevel) + "px";
      }
    }, { passive: false });

    // Ctrl+0 to reset zoom
    window.addEventListener("keydown", e => {
      if (e.ctrlKey && e.key === "0") {
        e.preventDefault();
        zoomLevel = 1;
        codeContainer.style.fontSize = baseFontSize + "px";
      }
    });

    // Run code button (calls Judge0 API)
    runBtn.onclick = runCode;

    async function runCode() {
      const source_code = codeBlockEl.textContent;
      const input = inputEl.value;
      statusMsg.textContent = "Running...";
      outputEl.value = "";
      runBtn.disabled = true;

      try {
        const response = await fetch("https://judge0-ce.p.rapidapi.com/submissions?base64_encoded=false&wait=true", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "X-RapidAPI-Key": "SIGN-UP-FOR-KEY", // Replace with your Judge0 RapidAPI key or use your own endpoint
            "X-RapidAPI-Host": "judge0-ce.p.rapidapi.com"
          },
          body: JSON.stringify({
            language_id: 50, // C language
            source_code,
            stdin: input
          })
        });
        if (!response.ok) throw new Error("Failed to run code");
        const result = await response.json();

        if (result.stdout) {
          outputEl.value = result.stdout;
        } else if (result.compile_output) {
          outputEl.value = "Compile Error:\n" + result.compile_output;
        } else if (result.stderr) {
          outputEl.value = "Runtime Error:\n" + result.stderr;
        } else {
          outputEl.value = "Unknown error occurred.";
        }
      } catch (error) {
        outputEl.value = "Error running code: " + error.message;
      } finally {
        statusMsg.textContent = "";
        runBtn.disabled = false;
      }
    }

    // Typing animation at bottom
    const typingText = document.getElementById("typingText");
    const typingPhrases = [
      "Farhan's C Practice Problems",
      "Click a file to view code",
      "Use Ctrl + Mouse Wheel to zoom code",
      "Press Ctrl+0 to reset zoom",
      "Run your code and check output"
    ];
    let typingIndex = 0;
    let charIndex = 0;
    let typingForward = true;

    function typingAnimation() {
      if (typingForward) {
        if (charIndex < typingPhrases[typingIndex].length) {
          typingText.textContent += typingPhrases[typingIndex][charIndex];
          charIndex++;
          setTimeout(typingAnimation, 120);
        } else {
          typingForward = false;
          setTimeout(typingAnimation, 2000);
        }
      } else {
        if (charIndex > 0) {
          typingText.textContent = typingText.textContent.slice(0, -1);
          charIndex--;
          setTimeout(typingAnimation, 50);
        } else {
          typingForward = true;
          typingIndex = (typingIndex + 1) % typingPhrases.length;
          setTimeout(typingAnimation, 500);
        }
      }
    }
    typingAnimation();

    // Initial folder load
    showFolder(folderPath);
  </script>
</body>
</html>
