<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>My C Practice - Dark Theme</title>

<!-- Prism.js for syntax highlighting -->
<link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.css" rel="stylesheet" />

<style>
  body {
    margin: 0; padding: 0;
    background-color: #121212;
    color: #e0e0e0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    display: flex;
    height: 100vh;
    overflow: hidden;
  }
  #sidebar {
    width: 300px;
    background-color: #1e1e1e;
    border-right: 1px solid #333;
    overflow-y: auto;
    padding: 20px;
  }
  #sidebar h2 {
    margin-top: 0;
    margin-bottom: 10px;
  }
  #file-list {
    list-style: none;
    padding-left: 0;
    max-height: 80vh;
    overflow-y: auto;
  }
  #file-list li {
    margin-bottom: 10px;
    cursor: pointer;
    padding: 6px 8px;
    border-radius: 5px;
    transition: background-color 0.3s ease;
  }
  #file-list li:hover {
    background-color: #333;
  }
  #file-list li.active {
    background-color: #0f9d58;
    color: #fff;
  }

  #main {
    flex: 1;
    display: flex;
    flex-direction: column;
    padding: 20px;
  }

  #header {
    display: flex;
    justify-content: flex-end;
    margin-bottom: 10px;
  }
  #run-button {
    background-color: #0f9d58;
    border: none;
    padding: 8px 16px;
    color: white;
    font-weight: bold;
    cursor: pointer;
    border-radius: 6px;
    transition: background-color 0.3s ease;
  }
  #run-button:hover:not(:disabled) {
    background-color: #0b7a43;
  }
  #run-button:disabled {
    background-color: #555;
    cursor: not-allowed;
  }

  #code-container {
    flex: 1;
    overflow: auto;
    background-color: #1e1e1e;
    border-radius: 8px;
    padding: 15px;
    box-shadow: 0 0 8px #0f9d58aa;
  }

  pre {
    margin: 0;
    font-size: 14px;
    line-height: 1.5;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  #input-area {
    width: 100%;
    margin-top: 15px;
    padding: 10px;
    font-family: monospace;
    font-size: 14px;
    border-radius: 6px;
    border: 1px solid #444;
    background-color: #222;
    color: #eee;
    resize: vertical;
    min-height: 80px;
  }

  #output-box {
    margin-top: 15px;
    background-color: #272727;
    border-radius: 6px;
    padding: 12px;
    height: 150px;
    overflow-y: auto;
    white-space: pre-wrap;
    color: #80ff72;
    font-family: monospace;
    font-size: 14px;
  }

  label {
    font-weight: bold;
  }
</style>
</head>
<body>

<div id="sidebar">
  <h2>My Practice (C Files)</h2>
  <ul id="file-list">
    <!-- ফাইলের নামগুলো JS দিয়ে এখানে যোগ হবে -->
  </ul>
</div>

<div id="main">
  <div id="header">
    <button id="run-button" disabled>Run Code</button>
  </div>

  <div id="code-container">
    <pre><code id="code-block" class="language-c">// Select a file to see the code here</code></pre>
  </div>

  <label for="input-area">Input (stdin):</label>
  <textarea id="input-area" placeholder="Enter input here, one value per line.&#10;Example:&#10;3&#10;10&#10;20&#10;30"></textarea>

  <div id="output-box">Output will appear here after running the code.</div>
</div>

<!-- Prism.js -->
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-c.min.js"></script>

<script>
  // তোমার GitHub ইউজারনেম আর রিপো নাম লিখো নিচে:
  const githubUser = 'wahidfarhan';  // তোমার GitHub username
  const repoName = 'Practice_C';     // তোমার রিপো নাম

  const fileListEl = document.getElementById('file-list');
  const codeBlock = document.getElementById('code-block');
  const runButton = document.getElementById('run-button');
  const inputArea = document.getElementById('input-area');
  const outputBox = document.getElementById('output-box');

  let currentCode = '';
  let activeFileLi = null;

  async function fetchFiles() {
    try {
      // 'codes' ফোল্ডারের ভিতরের সব ফাইল আনবে
      const res = await fetch(`https://api.github.com/repos/${githubUser}/${repoName}/contents/codes`);
      if (!res.ok) throw new Error('Failed to fetch repo content');
      const data = await res.json();

      // শুধু .c ফাইলগুলো বাছাই করবে
      const cFiles = data.filter(file => file.name.endsWith('.c'));

      fileListEl.innerHTML = '';

      if(cFiles.length === 0) {
        fileListEl.innerHTML = '<li style="color:#aaa;">No C files found in codes/ folder.</li>';
        runButton.disabled = true;
        return;
      }

      cFiles.forEach(file => {
        const li = document.createElement('li');
        li.textContent = file.name;
        li.title = "Click to view code";
        li.onclick = () => {
          if (activeFileLi) activeFileLi.classList.remove('active');
          li.classList.add('active');
          activeFileLi = li;
          loadCode(file.download_url);
        };
        fileListEl.appendChild(li);
      });

    } catch (err) {
      fileListEl.innerHTML = `<li style="color: red;">Error loading files: ${err.message}</li>`;
      runButton.disabled = true;
    }
  }

  async function loadCode(url) {
    try {
      const res = await fetch(url);
      if (!res.ok) throw new Error('Failed to load code file');
      const text = await res.text();
      currentCode = text;
      codeBlock.textContent = text;
      Prism.highlightElement(codeBlock);
      runButton.disabled = false;
      outputBox.textContent = 'Output will appear here after running the code.';
    } catch (err) {
      outputBox.textContent = `Error loading code: ${err.message}`;
      runButton.disabled = true;
    }
  }

  runButton.onclick = async () => {
    outputBox.textContent = 'Running...';

    try {
      const response = await fetch('https://judge0-ce.p.rapidapi.com/submissions?base64_encoded=false&wait=true', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'X-RapidAPI-Key': '2ffb7c9968msh2aaee0147c376edp10350djsne858c3d03a02',
          'X-RapidAPI-Host': 'judge0-ce.p.rapidapi.com'
        },
        body: JSON.stringify({
          language_id: 50,  // C language
          source_code: currentCode,
          stdin: inputArea.value
        })
      });

      const result = await response.json();

      if (result.stderr) {
        outputBox.textContent = 'Error:\n' + result.stderr;
      } else if (result.compile_output) {
        outputBox.textContent = 'Compile Error:\n' + result.compile_output;
      } else {
        outputBox.textContent = 'Output:\n' + result.stdout;
      }
    } catch (err) {
      outputBox.textContent = 'Execution failed: ' + err.message;
    }
  };

  // শুরুতেই ফাইলগুলো লোড করো
  fetchFiles();
</script>

</body>
</html>
